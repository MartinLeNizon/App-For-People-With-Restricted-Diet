<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediction Results</title>
    <link rel="stylesheet" href="{{url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div id="predictionResult">Loading prediction...</div>
    <div class="like-dislike">
        <button id="likeButton">üëç Like</button>
        <span id="likeCount">0</span>
        <button id="dislikeButton">üëé Dislike</button>
        <span id="dislikeCount">0</span>
    </div>
    <button id="languageSwitchButton" style="position: fixed; top: 50px; right: 100px;">FR</button>
    <div style="padding: 20px">
        <p id="disclaimer">Disclaimer: This is a demo application and the predictions are not real. The predictions are generated using a pre-trained model and are for demonstration purposes only. Use with caution.</p>
    </div>
    <script>
        // Function to parse URL parameters
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Display the prediction data
        function displayPrediction() {
            // Decode the URL parameter to get the prediction data
            const predictionDataParam = getQueryParam('data');
            if (predictionDataParam) {
                const predictionData = JSON.parse(decodeURIComponent(predictionDataParam));
                const predictionElement = document.getElementById('predictionResult');
                // Assuming the prediction data is a string or can be converted to string
                predictionElement.innerHTML = `
                    <img src="static/images/logo.jpg" alt="Logo" class="logo" style="top: 0%; left: 0%; max-width: 150px;"">
                    <div class="result-container">
                        <div class="prediction-card">
                            <h2 id="title">Prediction Result</h2>
                            <p id="predictionText">${predictionData.prediction}</p>
                        </div>
                    </div>
                `;
            } else {
                // Handle the case where no data parameter is present in the URL
                document.getElementById('predictionResult').innerHTML = '<p>No prediction data available.</p>';
            }
        }

        window.addEventListener('DOMContentLoaded', (event) => {
            displayPrediction();
        });

        document.addEventListener('DOMContentLoaded', function() {
        let likeCount = 0;
        let dislikeCount = 0;

        const likeButton = document.getElementById('likeButton');
        const dislikeButton = document.getElementById('dislikeButton');
        const likeCountElement = document.getElementById('likeCount');
        const dislikeCountElement = document.getElementById('dislikeCount');

        likeButton.addEventListener('click', function() {
            likeCount++; // Increment the like count
            likeCountElement.textContent = likeCount; // Update the display
        });

        dislikeButton.addEventListener('click', function() {
            dislikeCount++; // Increment the dislike count
            dislikeCountElement.textContent = dislikeCount; // Update the display
        });
    });

    function switchLanguage() {
        const predictionElement = document.getElementById('predictionText');
        const titleElement = document.getElementById('title');
        const disclaimerElement = document.getElementById('disclaimer');
        const likeButton = document.getElementById('likeButton');
        const dislikeButton = document.getElementById('dislikeButton');
        const languageSwitchButton = document.getElementById('languageSwitchButton');
        const currentLanguage = predictionElement.getAttribute('data-language');

        // English to French dictionary
        const englishToFrench = {
            'Gluten': 'Gluten',
            'Eggs': 'Oeufs',
            'Milk': 'Lait',
            'Nuts': 'Noix',
            'Peanuts': 'Arachides',
            'Soja': 'Soja',
            'Molluscs': 'Mollusques',
            'Fish': 'Poisson',
            'Lupin': 'Lupin',
            'Crustaceans': 'Crustac√©s',
            'Sesame': 'S√©same',
            'Mustard': 'Moutarde',
            'Celery': 'C√©leri',
            'Sulphites': 'Sulfites',
            'Yes': 'Oui',
            'No': 'Non',
        };

        // French to English dictionary
        const frenchToEnglish = {
            'Gluten': 'Gluten',
            'Oeufs': 'Eggs',
            'Lait': 'Milk',
            'Noix': 'Nuts',
            'Arachides': 'Peanuts',
            'Soja': 'Soja',
            'Mollusques': 'Molluscs',
            'Poisson': 'Fish',
            'Lupin': 'Lupin',
            'Crustac√©s': 'Crustaceans',
            'S√©same': 'Sesame',
            'Moutarde': 'Mustard',
            'C√©leri': 'Celery',
            'Sulfites': 'Sulphites',
            'Oui': 'Yes',
            'Non': 'No',
        };

        if (currentLanguage === 'french') {
            // Switch to English
            predictionElement.setAttribute('data-language', 'english');
            let text = predictionElement.textContent;
            for (const [frenchWord, englishWord] of Object.entries(frenchToEnglish)) {
                const regex = new RegExp(`\\b${frenchWord}\\b`, 'g');
                text = text.replace(regex, englishWord);
            }
            predictionElement.textContent = text;

            // Translate the title
            titleElement.textContent = "Prediction Result";

            // Translate the disclaimer
            disclaimerElement.textContent = "This is a demo application and the predictions are not real. The predictions are generated using a pre-trained model and are for demonstration purposes only. Use with caution.";

            // Translate the like and dislike buttons
            likeButton.textContent = "üëç Like";
            dislikeButton.textContent = "üëé Dislike";
            
            languageSwitchButton.textContent = "FR";
        } else {
            // Switch to French
            predictionElement.setAttribute('data-language', 'french');
            let text = predictionElement.textContent;
            for (const [englishWord, frenchWord] of Object.entries(englishToFrench)) {
                const regex = new RegExp(`\\b${englishWord}\\b`, 'g');
                text = text.replace(regex, frenchWord);
            }
            predictionElement.textContent = text;
            
            // Translate the title
            titleElement.textContent = "Pr√©diction";

            // Translate the disclaimer
            disclaimerElement.textContent = "Il s'agit d'une application de d√©monstration et les pr√©dictions ne sont pas r√©elles. Les pr√©dictions sont g√©n√©r√©es √† l'aide d'un mod√®le pr√©-entra√Æn√© et sont uniquement √† des fins de d√©monstration. Utilisez avec prudence.";

            // Translate the like and dislike buttons
            likeButton.textContent = "üëç J'aime";
            dislikeButton.textContent = "üëé Je n'aime pas";

            languageSwitchButton.textContent = "EN";
        }
    }

    // Add event listener to the language switch button
    const languageSwitchButton = document.getElementById('languageSwitchButton');
    languageSwitchButton.addEventListener('click', switchLanguage);


    </script>
</body>
</html>